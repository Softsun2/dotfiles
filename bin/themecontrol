#!/bin/sh

# Controls system wide themes
# I use dwm to trigger theme loading with a bind

THEME_PATH="$HOME"/.dotfiles/theme

loadtheme() {
  CURRENT_THEME=$(cat "$THEME_PATH"/.current-theme)

  # bg
  if [ -d "$THEME_PATH"/"$CURRENT_THEME"/bg ]
  then
    RANDOM_BG=$(
      ls "$THEME_PATH"/"$CURRENT_THEME"/bg | 
      shuf |
      head -n1 |
      awk '{print $1}'
    )
    feh --bg-fill --no-fehbg "$THEME_PATH"/"$CURRENT_THEME"/bg/"$RANDOM_BG"
  fi

  # dwm colors
  xrdb "$THEME_PATH"/"$CURRENT_THEME"/"$CURRENT_THEME"-dwm

  # vscode

  # nvim

  # firefox

  # ... 
}

nexttheme() {
  echo "set the next theme"
}

settheme() {
  # will probably want to check subdir structure
  test -d "$THEME_PATH/$1" &&
  echo "$1" > "$THEME_PATH/.current-theme" ||
  echo "Theme \"$1\" not found."
}

usage() {
  echo "usage:"
}

case "$1" in
  load) loadtheme ;;
  next) nexttheme ;;
  set) settheme "$2" ;;
  *) usage ;;
esac